\documentclass{beamer}
\usepackage[utf8]{inputenc}
\usepackage{ifpdf}
%\usepackage{hyperref}
\usepackage[english]{babel}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{color}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{units}
%\usepackage{multicol}
%\usepackage{moreverb}
\usepackage{listings}
%\usepackage{color}
%\usepackage{algorithm}
%\usepackage{algorithmicx}
%\usepackage{algpseudocode}
%\usepackage{longtable}
%\usepackage{geometry}
%\geometry{margin=2cm}
%\floatname{algorithm}{Algorithmus}

\usetheme[compress]{Berlin}

\newcommand{\beginbackup}{
   \newcounter{framenumbervorappendix}
   \setcounter{framenumbervorappendix}{\value{framenumber}}
}
\newcommand{\backupend}{
   \addtocounter{framenumbervorappendix}{-\value{framenumber}}
   \addtocounter{framenumber}{\value{framenumbervorappendix}} 
}

%%% now my own formatting

\useoutertheme{infolines} %% slick bottomline

\setbeamertemplate{headline}
{
  \leavevmode
  \begin{beamercolorbox}[wd=\paperwidth,ht=0.8cm,dp=-0.5pt]{page header}
    \vspace{0.250cm}\insertsectionnavigationhorizontal{\textwidth}{\hskip0pt plus1filll}{}
  \end{beamercolorbox}
  \vspace{-.1cm}
}

\setbeamertemplate{title page}
{
  \vspace{-2.3cm}
  \begin{beamercolorbox}[center,ht=.5\paperheight, wd=\paperwidth]{title}
    \begin{beamercolorbox}[center,ht=.5\paperheight, wd=.8\paperwidth]{title}
      \Large \inserttitle
      
      \normalsize\insertsubtitle
      \vspace{1cm}
    \end{beamercolorbox}
    \hrule{}
  \end{beamercolorbox}
  \begin{center}
    \insertauthor
    \vspace{.25cm}

    \insertinstitute
    
    \vspace{.25cm}
    
    \insertdate
  \end{center}
}

\setbeamertemplate{footline}
{
  \hbox{
    \begin{beamercolorbox}[wd=\paperwidth,ht=0.2cm,dp=0.2cm]{page footer}
      \begin{columns}
        \begin{column}{.33\paperwidth}
          \centering{}
          \insertshortauthor
        \end{column}
        \begin{column}{.33\paperwidth}
          \centering{}
          \insertshorttitle
        \end{column}
        \begin{column}{.33\paperwidth}
          \centering{}
          \insertframenumber / \inserttotalframenumber
        \end{column}
      \end{columns}
    \end{beamercolorbox}
  }
  \vskip0pt
}
\usenavigationsymbolstemplate{}

\setbeamercovered{transparent}

%\definecolor{pmmyellow}{HTML}{EFCC3C} %original from me
\definecolor{pmmyellow}{HTML}{FFFFFF} %hack: no yellow, but white!
\definecolor{pmmdarkblue}{HTML}{182B4B}

\setbeamercolor{palette primary}{fg=white,bg=pmmdarkblue}

\setbeamercolor{normal text}{bg=pmmyellow} %% background yellow

\setbeamercolor{page header}{bg=pmmdarkblue}
\setbeamercolor{page footer}{bg=pmmyellow}

% \setbeamercolor{frametitle}{bg=pmmdarkblue}
\setbeamercolor{block title}{bg=pmmdarkblue}
\setbeamercolor{block body}{bg=pmmyellow!95!black}
% \setbeamercolor{title}{bg=pmmdarkblue}
% \setbeamercolor{separation line}{bg=pmmdarkblue, fg=pmmdarkblue}
% \setbeamercolor{footline text}{fg=red}

\setbeamercolor{description item}{fg=pmmdarkblue}
\setbeamercolor{itemize item}{fg=pmmdarkblue}
\setbeamercolor{itemize subitem}{fg=pmmdarkblue}
\setbeamercolor{qed symbol}{fg=pmmdarkblue}
\setbeamercolor{section number projected}{bg=pmmdarkblue}
\setbeamercolor{section in toc}{fg=black}
\setbeamercolor{subsection number projected}{bg=pmmdarkblue}

\setbeamercolor{alerted text}{fg=red!70!black}


%%% end of my own formatting

\AtBeginPart{
  \begin{frame}
    \frametitle{Overview}
    \tableofcontents[currentpart]
  \end{frame}
}

% \documentclass{beamer}

% \usepackage[english]{babel}
% \usepackage[utf8]{inputenc}
% \usepackage{hyperref}
% \usepackage{amsmath}
% \usepackage{amssymb}
% \usepackage{graphicx}

% \usepackage{tikz}
\usepackage{subfigure}

\usepackage{comment}

\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{decorations.pathmorphing}

\newcommand{\todo}[1]{
  \textcolor{red}{TODO: #1}
  \note{\textcolor{red}{TODO: #1}}
}
% uncomment the following line if you want
% the todo's displayed in the file
\renewcommand{\todo}[1]{}
\newcommand{\korrektur}[1]{\textcolor{red}{\textbf{Korrektur:} #1}}
\newcommand{\reals}{\mathbb{R}}

\newcommand{\zoomfactor}{0.6}
\newcommand{\autozoomfactor}{0.15}

\renewcommand{\zoomfactor}{0.3}
\renewcommand{\autozoomfactor}{0.075}

\title[]{Approximation Analysis of the Lax-Friedrichs Flux in the Context of Shallow Water Equations}

\subtitle{Interdisciplinary project in Mathematics}
\author[S. Bakrac, P. Müller]{Stjepan Bakrac \and Philipp Müller}
\date{\today}
\institute[TU München]{Technische Universität München}

\newcommand{\partialderivative}[1]{\dfrac{\partial}{\partial #1}}
\newcommand{\pd}[2]{\dfrac{\partial #1}{\partial #2}}
\newcommand{\totalderivative}[1]{\dfrac{d}{d #1}}
\newcommand{\naturals}{\mathbb{N}}

\renewcommand{\phi}{\varphi}

\newcommand\intend{\mathrm{d}}

\DeclareMathOperator{\divergence}{div}

\AtBeginPart{\frame{\partpage}}

\definecolor{lightgray}{rgb}{0.6,0.6,0.8}

\begin{document}

\todo{Nicht vergessen, wieder reinzukommentieren!}
\frame{\titlepage}

\part{Short Introduction to Shallow Water Equations}
\label{part:introduction}

\section{Motivation}

\begin{frame}
  \frametitle{Introduction}
  \begin{itemize}
  \item Hyperbolic wave simulation
  \item (Adaptive) triangulation of the whole area
  \item How can we calculate the flux between triangles?
  \item Model continuous equations within these triangles
  \item Problem: Discontinuous due to spatial discretization
  \end{itemize}
  \begin{center}
    \includegraphics[scale=1.5]{sample-screenshot2.png}
  \end{center}
\end{frame}

%\section{Shallow Water Equations}

\begin{frame}
  \frametitle{Shallow Water Equations}
  \vspace{-.3cm}
  \begin{equation}
    \label{eq:shallow-water-basic}
    \pd{\mathbf{q}}{t} + \nabla \cdot F(\mathbf{q}) = r = \begin{pmatrix}
      0 \\ 0\\ 0
    \end{pmatrix}
  \end{equation}

  \begin{eqnarray*}
    \mathbf{q} =
    \begin{pmatrix}
      h \\ h v_x \\ h v_y
    \end{pmatrix} \quad \Rightarrow \quad F(\mathbf{q}) =
    \begin{pmatrix}
      h \mathbf{v} \\ h v_x \mathbf{v} + \frac{1}{2} g h^2 e_x \\ h
      v_y \mathbf{v} + \frac{1}{2} g h^2 e_y
    \end{pmatrix}
  \end{eqnarray*}
  \begin{eqnarray*}
    \mathbf{q} =
    \begin{pmatrix}
      h \\ u_x \\ u_y
    \end{pmatrix} \quad \Rightarrow \quad F(\mathbf{q}) =
    {
      \renewcommand{\arraystretch}{1.2}
      \begin{pmatrix}
        \mathbf{u} \\ \frac{u_x}{h} \mathbf{u} + \frac{1}{2} g h^2 e_x \\ \frac{u_y}{h} \mathbf{u}+
        \frac{1}{2} g h^2 e_y
      \end{pmatrix},
    }
  \end{eqnarray*}
  where $\mathbf{u}=
  \begin{pmatrix}
    u_x \\ u_y
  \end{pmatrix}$, $\mathbf{v} =
  \begin{pmatrix}
    v_x \\ v_y
  \end{pmatrix}$ and $\mathbf{u} = h\mathbf{v}$
%$\nabla \cdot
%  \begin{pmatrix}
%    a \\ b
%  \end{pmatrix} = \pd{a}{x} + \pd{b}{y}$
\end{frame}

\section{Discontinuous Galerkin}
\label{sec:basis-functions-intro}

\begin{frame}
  \frametitle{Discontinuous Galerkin}
  Multiply the equation by a test function $\phi$ and integrate over the domain:
  
  \begin{equation}
    \label{eq:shallow-water-weak-form}
    \int_T \pd {\mathbf{q}}{t} \phi \, dT + \int_T \nabla \cdot F(\mathbf{q}) \phi \, dT = 0
  \end{equation}

  Transform using the gaussian divergence theorem:

  \begin{equation}
    \label{eq:shallow-water-dg}
    \int_T \pd {\mathbf{q}}{t} \phi \, dT +
    \int_{\partial T} F(\mathbf{q}) \cdot \mathbf{n} \phi \, ds -
    \int_T F(\mathbf{q}) \cdot \nabla \phi \, dT = 0
  \end{equation}
  
  \begin{itemize}
  \item $T$ is a single triangle
  \item Whole domain $\Omega$ is represented by finite set of disjunct triangles
  \item Goal: Find solution for $\mathbf{q}$ $\forall \left(x,y\right) \in \Omega$
  \end{itemize}

\end{frame}

\begin{frame}
  \frametitle{Discontinuous Galerkin -- Remarks}
  \begin{itemize}
  \item Analytical solution for realistic scenarios still not found

  $\rightarrow$ numerical approximation
  \end{itemize}
  We use nodal basis functions:
  \begin{itemize}  
  \item Sample values at $n$ support points
  \item A basis function $\phi_i$ for each support point $\rightarrow$ nodal basis
  \item Approximate 
    $\mathbf{q} \approx \sum_{i=1}^n \mathbf{q}_i \phi_i(x,y)$ $\rightarrow$ Error since flux function not linear \todo{Correct?}
  \item Result: $\mathbf{q}_i$ does not depend on $x$ and $y$ anymore
  \end{itemize}

  \begin{equation}
    \label{eq:shallow-water-phi-i}
    \int_T \pd {\mathbf{q}}{t} \phi_i \, dT +
    \int_{\partial T} F(\mathbf{q}) \cdot \mathbf{n} \phi_i \, ds -
    \int_T F(\mathbf{q}) \cdot \nabla \phi_i \, dT = 0
  \end{equation}
\end{frame}

\section{Matrices}

% \begin{frame}
%   \frametitle{Simplifying Integrals}
%   \todo{Sollen wir diese Folie vielleicht rauslassen?}
%   \begin{equation*}
%     \label{sec:first-integral}
%     \int_T \pd {\mathbf{q}}{t} \phi_i \, dT \approx \sum_{j=1}^n \underbrace{\int_T \phi_i \phi_j \, dT}_{m_{ij}} \pd{\mathbf{q}_j}{t}
%   \end{equation*}
  
%   \begin{eqnarray*}
%     \label{sec:third-integral}
%     \int_T F_k(\mathbf{q}) \cdot \nabla \phi_i \, dT \approx &
%     \sum_{j=1}^n F_k^x\left(\mathbf{q}_j\right) \underbrace{\int_T \phi_j \pd{\phi_i}{x} \, dT}_{s^x_{ij}} \\
%     {} & + \sum_{j=1}^n F_k^y\left(\mathbf{q}_j\right) \underbrace{\int_T \phi_j \pd{\phi_i}{y} \, dT}_{s^y_{ij}}
%   \end{eqnarray*}

%   \begin{equation}
%     \label{eq:second-integral}
%     \int_{\partial T} F(\mathbf{q}) \cdot \mathbf{n} \, \phi_i \, ds = \sum_{e \in E} \sum_{k=0}^{m} F^e(p_k^e) \underbrace{\phi_i(p_k^e) \cdot w_k}_{w_{ik}^e}
%   \end{equation}
% \end{frame}

\begin{frame}
  \frametitle{Overview: Matrices}
  \vspace{-.3cm}
  \begin{equation*}
    \int_T \pd {\mathbf{q}}{t} \phi_i \, dT +
    \int_{\partial T} F(\mathbf{q}) \cdot \mathbf{n} \phi_i \, ds -
    \int_T F(\mathbf{q}) \cdot \nabla \phi_i \, dT = 0
  \end{equation*}
  \begin{block}{\emph{Precomputable} matrices (independent of $x$ and $y$)}
    \begin{description}
    \item[Mass matrix]
      \begin{equation}
        \label{eq:mass-matrix-overview}
        M = \int_T \phi_i \phi_j \ dT
      \end{equation}
    \item[Edge matrices] (one for each edge $e$) %$\forall e \in E$:
      \begin{equation}
        \label{eq:edge-matrices}
        W^e = \phi_i\left(p_k^e\right) \cdot w_k
      \end{equation}
    \item[Stiffness matrices]
      \begin{equation}
        \label{eq:stiffness-matrix-overview}
        S^x = \int_T \phi_j \pd{\phi_i}{x} \quad
        S^y = \int_T \phi_j \pd{\phi_i}{y}
      \end{equation}
    \end{description}
  \end{block}
\end{frame}

\begin{frame}
  \frametitle{Using the Matrices}
  We reformulate
  \begin{equation*}
    \int_T \pd {\mathbf{q}}{t} \phi_i \, dT +
    \int_{\partial T} F(\mathbf{q}) \cdot \mathbf{n} \phi_i \, ds -
    \int_T F(\mathbf{q}) \cdot \nabla \phi_i \, dT = 0
  \end{equation*}
  to
  \begin{equation*}
    M \cdot \pd{\tilde{\mathbf{q}}}{t} +
    \sum_{e \in E} \tilde{F}^e W^e -
    \left(F^x(\tilde{\mathbf{q}}) \cdot S^x +
      F^y(\tilde{\mathbf{q}}) \cdot S^y\right) = 0
  \end{equation*}
  \begin{block}{Explanations}
    \begin{itemize}
    \item $\tilde{\mathbf{q}} = (\mathbf{q}_1,\dots,\mathbf{q}_n)$ (remember: $\mathbf{q} \approx \sum_{i=1}^n \mathbf{q}_i \phi_i(x,y)$)
    \item $\tilde{F}^e=(F^e(p_1^e),\dots,F^e(p_n^e))$: $F^e$ is a function that handles communication between edges
    \item $F^x$ resp. $F^y$: $x$ resp. $y$-components of $F$
    \end{itemize}
  \end{block}
\end{frame}

% \begin{frame}
%   \frametitle{Rewriting Equations}
%   Remember:
%   \begin{equation*}
%     \int_T \pd {\mathbf{q}}{t} \phi \, dT +
%     \int_{\partial T} F\left(\mathbf{q}\right) \cdot n \phi \, ds -
%     \int_T F(\mathbf{q}) \cdot \nabla \phi \, dT = 0
%   \end{equation*}
%   % Using vectors $\tilde{\mathbf{q}} = (\mathbf{q}_1,\dots,\mathbf{q}_n)$ and $\tilde{F}^e=(F^e(p_1^e),\dots,F^e(p_n^e))$, we can rewrite it using our matrix definitions:
%   $\rightarrow$ Reformulate to:
%   \begin{equation*}
%     M \cdot \pd{\tilde{\mathbf{q}}}{t} +
%     \sum_{e \in E} \tilde{F}^e W^e -
%     \left(F^x(\tilde{\mathbf{q}}) \cdot S^x +
%       F^y(\tilde{\mathbf{q}}) \cdot S^y\right) = 0
%   \end{equation*}
%   \begin{block}{Explanations}
%     \begin{itemize}
%     \item $\tilde{\mathbf{q}} = (\mathbf{q}_1,\dots,\mathbf{q}_n)$
%     \item $\tilde{F}^e=(F^e(p_1^e),\dots,F^e(p_n^e))$
%     \item $F^x$ resp. $F^y$: $x$ resp. $y$-components of $F$
%     \end{itemize}
%   \end{block}
% \end{frame}

% \begin{frame}
%   \frametitle{Solving the Equation}
%   \begin{equation*}
%     M \cdot \pd{\tilde{\mathbf{q}}}{t} +
%     \sum_{e \in E} \tilde{F}^e W^e -
%     \left(F^x(\tilde{\mathbf{q}}) \cdot S^x +
%       F^y(\tilde{\mathbf{q}}) \cdot S^y\right) = 0
%   \end{equation*}
%   Rearrange and left-multiply with $M^{-1}$, afterwards explicit Euler:
%   \begin{equation*}
%     \pd{\tilde{\mathbf{q}}}{t} =
%     M^{-1} \cdot \left(
%       F^x(\tilde{\mathbf{q}}) \cdot S^x +
%       F^y(\tilde{\mathbf{q}}) \cdot S^y -
%       \sum_{e \in E} \tilde{F}^e W^e\right
%     )
%   \end{equation*}
%   \begin{equation*}
%     \Rightarrow \quad
%     \tilde{\mathbf{q}}_{k+1} =
%     \tilde{\mathbf{q}}_{k} \,+ \,
%     \tau \cdot M^{-1} \cdot \left(
%       F^x(\tilde{\mathbf{q}}) \cdot S^x +
%       F^y(\tilde{\mathbf{q}}) \cdot S^y -
%       \sum_{e \in E} \tilde{F}^e W^e\right
%     ),
%   \end{equation*}
%   where $\tilde{\mathbf{q}} = (\mathbf{q}_1,\dots,\mathbf{q}_n)$ and $\tilde{\mathbf{q}}_k$ is the value of $\tilde{\mathbf{q}}$ at time $k$.
% \end{frame}

% \section{Basis Functions}
% \label{sec:support-points-and-basis-functions}

% \begin{frame}
%   \frametitle{Choice of Support Points}
%   \begin{block}{Goal: Well-conditioned mass matrix $M$}
%     \begin{itemize}
%     \item Low degree of basis functions: Choose specific support
%       points
%     \item Higher degree: points derived by Dunavant\todo{Warum nochmal genau die?}
%     \end{itemize}
%   \end{block}

%   \begin{figure}[ht]
%     \centering
%     \subfigure[Degree 0]{
%       \begin{tikzpicture}[scale=1.5]
%         \draw[opacity=1] (0,0) -- node[left]{$e_3$} (0,1) -- node[right]{$e_2$} (1,0) -- node[below]{$e_1$} (0,0);
%         \draw[fill=blue] (0.333, 0.333) circle (0.02);
%       \end{tikzpicture}
%     }
%     \subfigure[Degree 1]{
%       \begin{tikzpicture}[scale=1.5]
%         \draw[opacity=1] (0,0) -- node[left]{$e_3$} (0,1) -- node[right]{$e_2$} (1,0) -- node[below]{$e_1$} (0,0);
%         \draw[fill=blue] (0.5, 0) circle (0.02);
%         \draw[fill=blue] (0, 0.5) circle (0.02);
%         \draw[fill=blue] (0.5, 0.5) circle (0.02);
%       \end{tikzpicture}
%     }
%     \subfigure[Degree 2]{
%       \begin{tikzpicture}[scale=1.5]
%         \draw[opacity=1] (0,0) -- node[left]{$e_3$} (0,1) -- node[right]{$e_2$} (1,0) -- node[below]{$e_1$} (0,0);
%         \draw[fill=blue] (0.5, 0) circle (0.02);
%         \draw[fill=blue] (0, 0.5) circle (0.02);
%         \draw[fill=blue] (0.5, 0.5) circle (0.02);
%         \draw[fill=blue] (0, 0) circle (0.02);
%         \draw[fill=blue] (1, 0) circle (0.02);
%         \draw[fill=blue] (0, 1) circle (0.02);
%       \end{tikzpicture}
%     }
%     \subfigure[Degree 3]{
%       \begin{tikzpicture}[scale=1.5]
%         \draw[opacity=1] (0,0) -- node[left]{$e_3$} (0,1) -- node[right]{$e_2$} (1,0) -- node[below]{$e_1$} (0,0);
%         \draw[fill=blue] (0.501, 0.249) circle (0.02);
%         \draw[fill=blue] (0.249, 0.249) circle (0.02);
%         \draw[fill=blue] (0.249, 0.501) circle (0.02);
%         \draw[fill=blue] (0.873, 0.063) circle (0.02);
%         \draw[fill=blue] (0.063, 0.063) circle (0.02);
%         \draw[fill=blue] (0.063, 0.873) circle (0.02);
%         \draw[fill=blue] (0.053, 0.310) circle (0.02);
%         \draw[fill=blue] (0.310, 0.636) circle (0.02);
%         \draw[fill=blue] (0.636, 0.053) circle (0.02);
%         \draw[fill=blue] (0.310, 0.053) circle (0.02);
%       \end{tikzpicture}
%     }
%   \end{figure}
% \end{frame}

% \begin{frame}
%   \frametitle{Choice of Basis Functions $\phi_i$}
%   \begin{block}{Polynomial basis functions}
%     \begin{itemize}
%     \item Polynomial functions that span the space of all polynomials up to a certain degree
%     \item Construct function $\phi_i$ so that 
%       $\forall i,j \in \{1, \dots, n\}$:
%       \begin{equation*}
%         \phi_i(p_j) = \delta_{ij}
%       \end{equation*}
%       with $\delta_{ij}$ being the Kronecker delta function.
%     \item Polynomials of degree $d$ $\rightarrow$
%       $\frac{(d+1)\cdot(d+2)}{2}$ nodal basis functions
%     \end{itemize}
%   \end{block}
% \end{frame}

\part{Comparing polynomials arising from exact and approximate solution of the Lax-Friedrichs Flux}
\label{part:polynomialstuff}

\section{A 1D problem}
\label{sec:interpretation-as-1d-problem}

\newcommand{\twopoints}[3]{
  \draw[fill=#3] (#1,#2) circle (0.05);
  \draw[xshift=0.1cm,yshift=0.1cm,fill=#3] (#1,#2) circle (0.05);
}

\begin{frame}
  \frametitle{Original Situation: 2D problem}
  \begin{itemize}
  %\item Two adjacent triangles
  \item Height and impulse are separate polynomial functions for \emph{each} triangle 

    $\rightarrow$ Discontinuity along common edges
    % \item We are interested in the situation along the common edge
  \item Simplification: Interpret as 1D problem
    
    $\rightarrow$ Parametrize edge by $x\in \left[ 0,1 \right]$ to describe the edge depending only on one variable
  \end{itemize}
  \begin{center}
    \begin{tikzpicture}[scale=2]
      \draw[draw=white] (-.1,-.3) rectangle (1.6,1.2);
      \begin{scope}[xshift=-.1em,yshift=-.1em]
        \draw[opacity=0.5] (0,0) -- (0,1) -- (1,0) -- (0,0); 
        \draw[thick] (0,1) -- (1,0);
      \end{scope}
      \draw[->,semithick] (0,1.075) -- node[right]{$x$} (1.075,0);
      \begin{scope}[xshift=1.15cm,yshift=1.15cm,rotate=180]
        \draw[opacity=0.5] (0,0) -- (0,1) -- (1,0) -- (0,0); 
        \draw[thick] (0,1) -- (1,0);
      \end{scope}
      \node[below, text width=3cm, align=center] at (.6,0) {\scriptsize{Parametrization $x\in\left[ 0,1 \right]$}};
    \end{tikzpicture}
    \begin{tikzpicture}[scale=2]
      \draw[draw=white] (-.1,-.3) rectangle (1.9,1.2);
      \draw (0,0) -- (0,1) -- (1,0) -- (0,0);
      \draw[xshift=0.1cm,yshift=0.1cm] 
      (1,0) -- (0,1) -- (1,1) -- (1,0);
      \twopoints{0.887}{1-0.887}{blue};
      \twopoints{0.5}{0.5}{red};
      \twopoints{1-0.887}{0.887}{yellow};
      % \begin{scope}[xshift=1.5cm,yshift=1cm]
      %   \draw[fill=blue] (0,0) circle (0.05) node[right]{\,$x=0$};
      %   \draw[fill=red] (0,-.3) circle (0.05) node[right]{\,$x=0.3$};
      %   \draw[fill=yellow] (0,-.8) circle (0.05) node[right]{\,$x=0.8$};
      % \end{scope}
      \node[below, text width=3cm, align=center] at (.6,0) {\scriptsize{Support points for Gauss quadrature}};
    \end{tikzpicture}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{One dimensional (Lax-Friedrichs) flux}
  Flux function:
  \begin{equation}
    \label{eq:flux-function-definition}
    F\left(
      \begin{pmatrix}
        h \\ u
      \end{pmatrix}
    \right) = 
    \begin{pmatrix}
      u \\
      \frac{1}{2} \frac{u^2}{h} + g h^2 
    \end{pmatrix}
  \end{equation}
  Lax-Friedrichs flux:
  \begin{equation}
    \label{eq:lax-friedrich-definition}
    F_{LF}(p^R,p^L) = \dfrac{1}{2}\cdot (F(p^R) + F(p^L)) - \alpha \cdot (p^R - p^L)
  \end{equation}
  \begin{block}{Remarks:}
    \begin{itemize}
    \item $p^R, p^L$: Data from the right and left triangle, respectively, containing height and impulse ($h$ and $u$)
    \item $p^R, p^L$ can be fixed over the whole triangle or can be functions (e.g. polynomials) returning two components
    \todo{Muesen wir das mit fixed ueberhaupt erwaehnen? Ist ja nur ein Spezialfall von Polynomen}
    \end{itemize}
  \end{block}
\end{frame}

\section{Polynomials}
\label{sec:constructing-polynomials}

\begin{frame}
  \frametitle{Choice of Support Points for Polynomials}
  \begin{itemize}
  \item In principle: arbitrary
  \item In practice: Use support points from Gaussian quadrature since we'll apply it later
  \item Sample values for $h$ and $u$ for those points.
    \begin{center}
      \begin{tikzpicture}[scale=2]
        \begin{scope}[scale=0.8]
          \begin{scope}[xshift=-.1em,yshift=-.1em]
            \draw (0,0) -- (0,1) -- (1,0) -- (0,0); 
            \draw[fill=blue] (0.113,0.887) circle (0.05); 
            \draw[fill=blue] (0.5,0.5) circle (0.05); 
            \draw[fill=blue] (0.887,0.113) circle (0.05); 
            \node at (0.3,0.3) {$L$};
          \end{scope}
          %\draw[->,semithick] (0,1.075) -- node[right]{$x$} (1.075,0);
          \begin{scope}[xshift=1.15cm,yshift=1.15cm,rotate=180]
            \draw (0,0) -- (0,1) -- (1,0) -- (0,0); 
            \draw[fill=blue] (0.113,0.887) circle (0.05); 
            \draw[fill=blue] (0.5,0.5) circle (0.05); 
            \draw[fill=blue] (0.887,0.113) circle (0.05); 
            \node at (0.3, 0.3) {$R$};
          \end{scope}
        \end{scope}
        \draw[decorate,decoration=snake,->]
        (1.2,.51) -- (1.7,.51);
        \begin{scope}[xshift=2cm]
          \draw[->](0,0)--node[below]{edge$_L$}(1.2,0) node[right]{$x$};
          \draw[->](0,0)--(0,1) node[above]{Imp.$_L$};
          \draw(0,0) -- (0,-.032) node[below]{0};
          \draw(1,0) -- (1,-.032) node[below]{1};
          \draw[fill=blue] (0.113, 0.205) circle (0.025);
          \draw[fill=blue] (0.500, 0.125) circle (0.025);
          \draw[fill=blue] (0.887, 0.63) circle (0.025);
        \end{scope}
        \begin{scope}[xshift=3.5cm]
          \draw[->](0,0)--node[below]{edge$_R$}(1.2,0) node[right]{$x$};
          \draw[->](0,0)--(0,1) node[above]{Imp.$_R$};
          \draw(0,0) -- (0,-.032) node[below]{0};
          \draw(1,0) -- (1,-.032) node[below]{1};
          \draw[fill=blue] (0.113, 0.56) circle (0.025);
          \draw[fill=blue] (0.500, 0.72) circle (0.025);
          \draw[fill=blue] (0.887, 0.8) circle (0.025);
        \end{scope}

      \end{tikzpicture}
    \end{center}
    % \item We also tested equidistant support points
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Constructing the Polynomials}
  Remember:
  \begin{equation*}
    F_{LF}(p^R,p^L) = \dfrac{1}{2}\cdot (F(p^R) + F(p^L)) - \alpha \cdot (p^R - p^L)
  \end{equation*}
  \begin{itemize}
  \item Pick $m$ points for each of the edges: 
    % Points of the left triangle:
    % $\left(x_1,\begin{pmatrix}
    %     h_1^R \\ u_1^R
    %   \end{pmatrix}\right), \dots , \left(x_n, \begin{pmatrix}
    %     h_n^R \\ u_n^R
    %   \end{pmatrix}\right)$ and the points for the right triangle 
    % $\left(x_1,\begin{pmatrix}
    %     h_1^L \\ u_1^L
    %   \end{pmatrix}\right), \dots , \left(x_n,\begin{pmatrix}
    %     h_n^L \\ u_n^L
    %   \end{pmatrix}\right)$. (Each point has height and impulse.)
  \item Right triangle points: $\left(x_1,\begin{pmatrix}
        h_1^R \\ u_1^R
      \end{pmatrix}\right), \dots , \left(x_m, \begin{pmatrix}
        h_m^R \\ u_m^R
      \end{pmatrix}\right)$
  \item Analogous for the left triangle
  \item Each point has height ($h$) and impulse ($u$)
  %\item Assign height and impulse to each of the $2n$ points
    % \item Generate 4 polynomials by interpolation (height/impulse for left/right triangle)

    %   $\rightarrow$ Example: Impulse, right triangle: $(x_i, u_i^R)$
    %   \begin{itemize}
    %   \item Height, right triangle: $(x_i, h_i^R)$
    %   \item Impulse, right triangle: $(x_i, u_i^R)$
    %   \item Height, left triangle: $(x_i, h_i^L)$
    %   \item Impulse, left triangle: $(x_i, u_i^L)$
    %   \end{itemize}
    % \item Group right polynomials into $p^R$, left polynomials into $p^L$
  \end{itemize}

  \begin{center}
    \begin{tikzpicture}[scale=1.5]
      \begin{scope}[xshift=2cm]
        \draw[->](0,0) --
        %node[below]{edge$_L$}
        (1.2,0) node[right]{$x$};
        \draw[->](0,0)--(0,1) node[above]{Imp.$_L$};
        \draw(0,0) -- (0,-.032) node[below]{0};
        \draw(1,0) -- (1,-.032) node[below]{1};
        \draw[] (0.,0.3) parabola bend (0.4,0.1) (1,0.9);
        \draw[fill=blue] (0.113, 0.205) circle (0.025);
        \draw[fill=blue] (0.500, 0.125) circle (0.025);
        \draw[fill=blue] (0.887, 0.63) circle (0.025);
      \end{scope}
      \begin{scope}[xshift=3.5cm]
        \draw[->](0,0) --
        %node[below]{edge$_R$}
        (1.2,0) node[right]{$x$};
        \draw[->](0,0)--(0,1) node[above]{Imp.$_R$};
        \draw(0,0) -- (0,-.032) node[below]{0};
        \draw(1,0) -- (1,-.032) node[below]{1};
        \draw[] (0.,0.5) parabola bend (1,0.8) (1,0.8);
        \draw[fill=blue] (0.113, 0.56) circle (0.025);
        \draw[fill=blue] (0.500, 0.72) circle (0.025);
        \draw[fill=blue] (0.887, 0.8) circle (0.025);
      \end{scope}
    \end{tikzpicture}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Interpolation}
  Interpolation routine:
  \begin{equation*}
    interpolate(\{(x_i,y_i) \mid i \in \{1 \dots n\}\})
  \end{equation*}
  yields a polynomial of minimum degree (i.e. $n-1$) interpolating all given points $(x_i,y_i)$.

  Shorter notation: 
  \begin{equation*}
    interpolate(x,y)
  \end{equation*}

  \begin{itemize}
  \item $p^L_h(x) := interpolate (x,h^L)$. Height for left triangle.
  \item $p^L_u(x) := interpolate (x,u^L)$. Impulse for left triangle.
  \item $p^R_h(x) := interpolate (x,h^R)$. Height for right triangle.
  \item $p^R_u(x) := interpolate (x,u^R)$. Impulse for right triangle.
  \end{itemize}

  \begin{equation*}
    p^L(x) :=
    \begin{pmatrix}
      p^L_h(x) \\ p^L_u(x)
    \end{pmatrix}, \quad
    p^R(x) :=
    \begin{pmatrix}
      p^R_h(x) \\ p^R_u(x)
    \end{pmatrix}
  \end{equation*}
\end{frame}

\section{Approximation vs. Exact Result}
\label{sec:comparing-approx-and-exact-result}

\begin{frame}
  \frametitle{Comparison of $N(x)$ and $N'(x)$}
  \begin{columns}
    \begin{column}{.5\textwidth}
      \begin{block}{Exact solution}
        \vspace{-.3cm} % sorry
        \begin{equation*}
          N(x) := F_{LF}(p^R(x),p^L(x))
        \end{equation*}
      \end{block}
      \begin{block}{Approximate solution}
        \vspace{-.5cm} % sorry
        \begin{equation*}
          F_{LF}\left(
            \begin{pmatrix}
              h_i^R \\ u_i^R
            \end{pmatrix},
            \begin{pmatrix}
              h_i^L \\ u_i^L
            \end{pmatrix}
          \right) :=
          \begin{pmatrix}
            h_i^F \\ u_i^F
          \end{pmatrix} %= F_i % wird später nicht referenziert
        \end{equation*}
        \vspace{-.1cm} % sorry
        \begin{equation*}
          N'(x) :=
          \begin{pmatrix}
            interpolate(x,h^F) \\ interpolate(x,u^F)
          \end{pmatrix}
        \end{equation*}        
      \end{block}
    \end{column}
    \begin{column}{.4\textwidth}
      \begin{center}
        \begin{tikzpicture}[scale=0.7]
          \draw[->] (0,0) -- (5.5,0) node[right]{$x$};
          \draw[->] (0,0) -- (0,5) node[above]{$y$};
          \draw (0,0) -- (0,-0.1) node[below]{0};
          \draw (5,0) -- (5,-0.1) node[below]{1};
          \draw[red] 
          (0,0) .. controls(2.5,4) .. (5,4.5) 
          node[right,yshift=-.1cm]{$N'(x)$};
          \draw[blue] 
          (0,0.4) .. controls(1.5,0.5) and (2.1,3.7) .. 
          (2.9,4) .. controls (4.5,4.2) .. 
          (5,5) 
          node[right,yshift=.1cm]{$N(x)$};
          \draw[fill opacity=0.5,fill=yellow,draw opacity=0] 
          (0,0) .. controls(2.5,4) .. (5,4.5) -- (5,5)
          .. controls (4.5,4.2) .. (2.9,4)
          .. controls (2.1,3.7) and (1.5,0.5) .. (0,0.4) 
          ;
          \draw[dashed, draw opacity=0.5] (5,5) -- (5,0);
        \end{tikzpicture}
        % \includegraphics[scale=0.3]{quadrature_vs_analytic}
      \end{center}
    \end{column}
  \end{columns}
  
  \begin{center}
    $\rightarrow$ Quality of approximation? $L^1$ norm: $I := \int\limits_{x=0}^1 | N(x) - N'(x) |\ dx$ \todo{Hier wollte der Martin $L^1$-Norm drinstehen haben. Zu wenig Platz}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Some Considerations}
  \begin{equation*}
    I := \int\limits_{x=0}^1 | N(x) - N'(x) |\ dx
  \end{equation*}
  \begin{itemize}
  \item $N$ might have singularities (w.r.t. $x$ -- depending on $h_i$ and $u_i$) 

    $\rightarrow$ Not in $[0,1]$ for reasonable values of $h_i$ and $u_i$
  \item $N(x)-N'(x)$ depends on $4n$ variables
    
    ($n$ support points $\rightarrow$ $2n$ parameters per triangle)
    % \begin{itemize}
    % \item Two edges
    % \item $n$ points on each edge
    % \item Each point has height and impulse
    % \end{itemize}
    % $\rightarrow$ $I$ depends on $4n$ variables
  \item Maple could not find general analytic solutions \todo{Rausnehmen?}
  \item Alternative: Visualization -- fix all but at most 2 variables
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Evaluating the Expression $I$}
  \vspace{-.3cm} % sorry
  \begin{equation*}
    I := \int\limits_{x=0}^1 | N(x) - N'(x) |\ dx
  \end{equation*}

  \begin{columns}
    \begin{column}{.55\textwidth}
      \begin{itemize}
      \item Analytic solution -- not feasible (zeroes hard to compute)
      \item Approximate without absolute value -- not accurate
      \item Piecewise integration between support points $x_i$ -- too slow
      \item Maple's \texttt{evalf} -- too slow
      \item $\rightarrow$ Simple: 
        Numerical integration using the 
        rectangle method using $s$ rectangles
      \end{itemize}
    \end{column}
    \begin{column}{.45\textwidth}
      \begin{center}
        \begin{tikzpicture}[scale=1.5]
          \draw[help lines, -] (0,0) node[below,color=black]{0} -- (0,2.25);
          \draw[help lines, -] (2,0) node[below,color=black]{1} -- (2,2.25);
          \draw[->] (-0.25,0) -- (2.25,0) node[right]{$x$};
          \draw[draw opacity=0.5, draw=black, fill opacity=0.5, fill=yellow] (0,0) rectangle (0.5,1.890625);
          \draw[draw opacity=0.5, draw=black, fill opacity=0.5, fill=yellow] (0.5,0) rectangle (1,1.296875);
          \draw[draw opacity=0.5, draw=black, fill opacity=0.5, fill=yellow] (1,0) rectangle (1.5,0.828125);
          \draw[draw opacity=0.5, draw=black, fill opacity=0.5, fill=yellow] (1.5,0) rectangle (2,1.234375);
          \draw[domain=-0.2:2.1] plot (\x, {\x*\x*\x-2*\x*\x+2}) node[above]{$|N(x)-N'(x)|$};
          \draw[fill=blue] (0.25,1.890625) circle (0.02);
          \draw[fill=blue] (0.75,1.296875) circle (0.02);
          \draw[fill=blue] (1.25,0.828125) circle (0.02);
          \draw[fill=blue] (1.75,1.234375) circle (0.02);
          \draw[decorate,decoration=brace,-] (1,-0.05) -- node[below]{\scriptsize{$\frac{1}{s}$}} (0.5,-0.05);
        \end{tikzpicture}
      \end{center}
      
    \end{column}
  \end{columns}
  
\end{frame}

\begin{frame}
  \frametitle{Demonstration}
  \begin{center}
    \Large{Demo}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Results}
  \begin{itemize}
  \item Height error almost zero
  \item Impulse error mainly influenced by $h$ component

  $\rightarrow$ lowest near the average $h$ value
  \item Impulse error unbounded
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Outlook}
  \begin{block}{Within this IDP}
    \begin{itemize}
    \item Analysis of stiffness matrix
      % \begin{equation}
      %   \label{eq:stiffness-matrix-overview}
      %   S^x = \int_T \phi_j \pd{\phi_i}{x} \quad
      %   S^y = \int_T \phi_j \pd{\phi_i}{y}
      % \end{equation}
    \end{itemize}
  \end{block}
  \begin{block}{Related questions}
    \begin{itemize}
    \item Other flux functions \todo{Beispiele?}
    \item Different placement of support points
    \item Bathymetry
    \end{itemize}
  \end{block}
\end{frame}

\beginbackup
\appendix{}

\frame{
  \frametitle{Deferred Explanations}
  \tableofcontents
}

\section{Simplifying integrals}
\label{sec:appendix-simplifying-integrals}

\begin{frame}
  \frametitle{First Integral: Mass Matrix}

  \begin{eqnarray*}
    \int_T \pd {\mathbf{q}}{t} \phi_i \, dT & \approx &
    \int_T \pd {\left( \sum_{j=1}^n \mathbf{q}_j \phi_j \right) }{t} \phi_i \, dT \\
    & = & \sum_{j=1}^n \underbrace{\int_T \phi_i \phi_j \, dT}_{m_{ij}} \pd{\mathbf{q}_j}{t}
  \end{eqnarray*}
  
  \begin{itemize}
  \item Result: Mass matrix $M = [m_{ij}]_{n \times n}$
  \item Interpret the above as a matrix multiplication
  \end{itemize}

  \begin{equation*}
    \int_T \pd {\mathbf{q}}{t} \phi_i \, dT \approx
    M \cdot \pd{
      \left( \mathbf{q}_1 , \dots , \mathbf{q}_n  \right)^T }
    {t}
  \end{equation*}
\end{frame}

\begin{frame}
  \frametitle{Third Integral: Stiffness matrix -- $h$ component}
  \begin{eqnarray*}
    \int_T F_1(\mathbf{q}) \cdot \nabla \phi_i \, dT & = &
    \int_T
    \begin{pmatrix}
      u_x \\ u_y
    \end{pmatrix}
    \cdot \nabla \phi_i \, dT \\
    & \approx & \int_T 
    \begin{pmatrix} 
      \sum_{j=1}^n u_{x,j} \phi_j \\
      \sum_{j=1}^n u_{y,j} \phi_j \\
    \end{pmatrix}
    \cdot 
    {
      \renewcommand\arraystretch{2}
      \begin{pmatrix}
        \pd{\phi_i}{x} \\
        \pd{\phi_i}{y} 
      \end{pmatrix} dT 
    }\\
    & = & \sum_{j=1}^n u_{x,j} \underbrace{\int_T \phi_j \pd{\phi_i}{x} \, dT}_{s^x_{ij}} + \sum_{j=1}^n u_{y,j} \underbrace{\int_T \phi_j \pd{\phi_i}{y} \, dT}_{s^y_{ij}}
  \end{eqnarray*}
  \begin{itemize}
  \item Result: Stiffness matrices $S^x = [s_{ij}^x]_{n \times n}$ and $S^y = [s_{ij}^y]_{n \times n}$
  \item Interpret sums as matrix multiplications
  \end{itemize}
\end{frame}

% \begin{frame}
%   \frametitle{Intermezzo: Point-wise Approximation}
%   \begin{itemize}
%   \item   $\mathbf{q}\approx \sum_{i=1}^n \mathbf{q}_i \phi_i$, i.e.\,$
%     \begin{pmatrix}
%       h \\ u_x \\ u_y
%     \end{pmatrix} = \sum_{i=1}^n
%     \begin{pmatrix}
%       h_i \\ u_{x,i} \\ u_{y,i}
%     \end{pmatrix}
%     \phi_i$
%   \item   We would like to compute function value
%     \begin{equation*}
%       f(\mathbf{q}) \approx
%       f\left(\sum_{i=1}^n h_i \phi_i,
%         \sum_{i=1}^n u_{x,i} \phi_i,
%         \sum_{i=1}^n u_{y,i} \phi_i\right),
%     \end{equation*}
%   \item   Too complex $\rightarrow$ compute the following:
%     \begin{equation*}
%       \sum_{i=1}^n f(h_i,u_{x,i},u_{y,i}) \phi_i.
%     \end{equation*}
%   \end{itemize}
% \end{frame}
% 
\begin{frame}
  \frametitle{Third Integral: Stiffness matrix -- $u_x$ component}
  \begin{eqnarray*}
    \label{sec:third-integral-second-line-1}
    \int_T F_2(\mathbf{q}) \cdot \nabla \phi_i \, dT & = &
    \int_T
    \begin{pmatrix}
      \frac{u_x^2}{h} + \frac{1}{2} g h^2 \\ \frac{u_x u_y}{h}
    \end{pmatrix}
    \cdot \nabla \phi_i \, dT \\
    \label{sec:third-integral-second-line-2}
    & \approx &
    \int_T 
    \begin{pmatrix}
      \sum_{j=1}^n \left(\frac{u_{x,j}^2}{h_j^2} + \frac{1}{2} g h_j^2\right) \phi_j \\
      \sum_{j=1}^n \left(\frac{u_{x,j} u_{y,j}}{h_j}\right) \phi_j \\
    \end{pmatrix}
    \cdot 
    {
      \renewcommand{\arraystretch}{2}
      \begin{pmatrix}
        \pd{\phi_i}{x} \\
        \pd{\phi_i}{y} 
      \end{pmatrix} dT 
    } \\
    & = & \nonumber \sum_{j=1}^n \left(\frac{u_{x,j}^2}{h_j^2} + \frac{1}{2} g h_j^2\right) \int_T \phi_j \pd{\phi_i}{x} \, dT \\ 
    & {} & + \nonumber \sum_{j=1}^n \left(\frac{u_{x,j} u_{y,j}}{h_j}\right) \int_T \phi_j \pd{\phi_i}{y} \, dT
  \end{eqnarray*}
  \begin{itemize}
  \item Point-wise approximation in the second line
  \item Same stiffness matrices $S^x$ and $S^y$ as before $\rightarrow$ interpret as matrix multiplication
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Third Integral: Stiffness matrix -- $u_y$ component}
  \begin{eqnarray*}
    \int_T F_3\left(\mathbf{q}\right) \cdot \nabla \phi_i \, dT & = &
    \int_T
    \begin{pmatrix}
      \frac{u_x u_y}{h} \\ \frac{u_y^2}{h} + \frac{1}{2} g h^2 
    \end{pmatrix}
    \cdot \nabla \phi_i \, dT \\
    & \approx & \int_T 
    \begin{pmatrix}
      \sum_{j=1}^n \left(\frac{u_{x,j} u_{y,j}}{h_j}\right) \phi_j \\
      \sum_{j=1}^n \left(\frac{u_{y,j}^2}{h_j^2} + \frac{1}{2} g h_j^2\right) \phi_j \\
    \end{pmatrix}
    \cdot 
    {
      \renewcommand{\arraystretch}{2}
      \begin{pmatrix}
        \pd{\phi_i}{x} \\
        \pd{\phi_i}{y} 
      \end{pmatrix} dT 
    } \\
    & = & \sum_{j=1}^n \left(\frac{u_{x,j} u_{y,j}}{h_j}\right) \int_T \phi_j \pd{\phi_i}{x} \, dT \\
    & {} & + \sum_{j=1}^n \left(\frac{u_{y,j}^2}{h_j^2} + \frac{1}{2} g h_j^2\right) \int_T \phi_j \pd{\phi_i}{y} \, dT
  \end{eqnarray*}
\end{frame}

\begin{frame}
  \frametitle{Second Integral: Border Integral}
  Split into triangle edges:
  \begin{equation}
    \label{eq:border-integral-sum}
    \int_{\partial T} F(\mathbf{q}) \cdot \mathbf{n} \, \phi_i \, ds = \sum_{e \in E} \int_{e} F^e \phi_i \, ds
  \end{equation}
  \begin{itemize}
  \item Normals are incorporated in $F^e$
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Border Integral}
  Compute $\sum_{e \in E} \int_{e} F^e \phi_i \, ds$ by Gaussian quadrature:

  \begin{equation}
    \int_{e} F^e \phi_i \, ds \approx \sum_{k=0}^{m} F^e(p_k^e) \underbrace{\phi_i(p_k^e) \cdot w_k}_{w_{ik}^e},
  \end{equation}
  Result: Edge matrices $W^e = [w_{ik}^e]_{n \times m} \quad \forall e \in E$
  \begin{block}{Remarks}
    \begin{itemize}
    \item $m$: Number of support points for Gaussian quadrature
    \item $p_k^e$: Support point with index $k$ on edge $e$
    \item $w_k$: corresponding quadrature weight
    \item $F^e$: Numerical flux function along that edge
    \end{itemize}
  \end{block}
\end{frame}

\section{Explicit Euler}
\label{sec:appendix-explicit-euler}

\begin{frame}
  \frametitle{Intermezzo: Explicit Euler}
  \begin{eqnarray}
    \label{eq:euler-method-setting}
    \pd{x(t)}{t} &=& f(t, x(t)). \\
    x(t_0) &=& x_0
  \end{eqnarray}
  
  Timesteps with distance $\tau$: $t_{k+1} = t_k + \tau$.
  
  \begin{equation}
    \label{eq:euler-step-solution}
    x_{k+1} = x_k + \tau f(t_k, x_k), \quad k=0,1,2,\dots
  \end{equation}
  
\end{frame}


\section{Thoughts on how to evaluate $I$}
\label{sec:appendix-evaluate-I}

\begin{frame}
  \frametitle{Evaluating $I$}
  \begin{equation*}
    I := \int\limits_{x=0}^1 | N(x) - N'(x) |\ dx
  \end{equation*}
  \begin{itemize}
  \item Complicated analycital solution (absolute value/rational function)
  \item Possibility 1: Approximate $I$ by $\int\limits_{x=0}^1 N(x) - N'(x) \  dx$. Bad!
  \item Fact: $N(x_i) = N'(x_i)$ 
    $\rightarrow$ $N(x_i) - N'(x_i) = 0$
  \item Piecewise integration between the $x_i$'s:
    \begin{equation*}
      \sum\limits_{i=1}^{n-1} \left|\ \int\limits_{x=x_i}^{x_{i+1}} N(x) - N'(x) \  dx\ \right|
    \end{equation*}
    \begin{itemize}
    \item Accuracy can be improved by ``adding $x_i$'s''
    \item Seems quite good, but really, really, really slow
    \item Accuracy can be improved by ``adding $x_i$'s''
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Evaluating $I$ -- Numerical integration}
  \begin{itemize}
  \item Maple's intrinsic integration:  
    \begin{center}
      \texttt{evalf(Int(abs(N(x)-N'(x)),x=0..1))}
    \end{center}
    works, but takes much too long for general parameters!
  \item Old-school: Numerical integration using the ``Streifenmethode'' using $s$ stripes:
    % \todo{Wie heißt das auf Englisch?} \todo{Im Skript diese Methode nachreichen!}
    % \begin{equation*}
    %   \int\limits_{x=0}^1 N(x)-N'(x)\,dx \approx \sum_{i=0}^{s-1} \left| N\left(\frac{1}{2s} + \frac{i}{s}\right) - N'\left(\frac{1}{2s} + \frac{i}{s}\right) \right| \cdot \frac{1}{s}
    % \end{equation*}
    % \todo{Skizze dazu unbedingt nötig!}
    
    \begin{center}

      \begin{tikzpicture}[scale=1.5]
        \draw[help lines, -] (0,0) node[below,color=black]{0} -- (0,2.25);
        \draw[help lines, -] (2,0) node[below,color=black]{1} -- (2,2.25);
        \draw[->] (-0.25,0) -- (2.25,0) node[right]{$x$};
        \draw[draw opacity=0.5, draw=black, fill opacity=0.5, fill=yellow] (0,0) rectangle (0.5,1.890625);
        \draw[draw opacity=0.5, draw=black, fill opacity=0.5, fill=yellow] (0.5,0) rectangle (1,1.296875);
        \draw[draw opacity=0.5, draw=black, fill opacity=0.5, fill=yellow] (1,0) rectangle (1.5,0.828125);
        \draw[draw opacity=0.5, draw=black, fill opacity=0.5, fill=yellow] (1.5,0) rectangle (2,1.234375);
        \draw[domain=-0.2:2.1] plot (\x, {\x*\x*\x-2*\x*\x+2}) node[above]{$|N(x)-N'(x)|$};
        \draw[fill=blue] (0.25,1.890625) circle (0.02);
        \draw[fill=blue] (0.75,1.296875) circle (0.02);
        \draw[fill=blue] (1.25,0.828125) circle (0.02);
        \draw[fill=blue] (1.75,1.234375) circle (0.02);
        \draw[decorate,decoration=brace,-] (1,-0.05) -- node[below]{\scriptsize{$\frac{1}{s}$}} (0.5,-0.05);
      \end{tikzpicture}
    \end{center}
  \end{itemize}
\end{frame}


\begin{comment}
  \subsection{Some considerations to take into account}
  \label{sec:some-considerations}

  Later we will explain how we can visualize $I$. Since there are many variables to choose, we decided to fix all but one point and visualize the result.

  For example, if we fixed all points to $
  \begin{pmatrix}
    10 \\ 0
  \end{pmatrix}
  $ except the first point, this would mean we are interested in 
  \begin{equation*}
    I\left(
      \begin{pmatrix}
        h_1^R \\ u_1^R
      \end{pmatrix},
      \begin{pmatrix}
        10 \\ 0
      \end{pmatrix},
      \begin{pmatrix}
        10 \\ 0
      \end{pmatrix}, \dots
      \begin{pmatrix}
        10 \\ 0
      \end{pmatrix}
    \right).
  \end{equation*}

  \subsection{How to interpret the pictures}
  \label{sec:how-to-interpret-pictures}

  Next we can take a look at figure \ref{fig:two-points-all-the-same}. In this example, we used 2 points on each triangle and edge. That is, we have four (relevant) points in total. This is why figure \ref{fig:two-points-all-the-same} has four sub-figures.

  Looking at sub-figure \ref{subfig:fixing-p2-in-first-example}, its caption says ``$p_2^R$: 1/0.04''. The first part of this caption tells us that we are fixing \emph{all points except} $p_2^R$ to a specific value (in this case it was $
  \begin{pmatrix}
    10 \\ 0
  \end{pmatrix}
  $), i.e. we are considering the term $I\left(
    \begin{pmatrix}
      10 \\ 0
    \end{pmatrix},
    \begin{pmatrix}
      h_2^R \\ u_2^R
    \end{pmatrix}, 
    \begin{pmatrix}
      10 \\ 0
    \end{pmatrix},
    \begin{pmatrix}
      10 \\ 0
    \end{pmatrix}
  \right)$.

  In subfigure \ref{subfig:fixing-p2-in-first-example}, we deal with a function that has two variables (namely $h_2^R$ and $u_2^R$). Thus, we can create a 3D plot showing this function. Please remember that $I$ was a \emph{vector} containing two components. This is why subfigure \ref{subfig:fixing-p2-in-first-example} contains two plots. The left plot stands for the $h$ component, while the right one represents the $u$ component.

  The orientation of the axes is displayed in figure \ref{fig:orientation-of-axes}.

  \begin{figure}[th]
    \centering
    \begin{tikzpicture}
      \draw[->,semithick] (0,0) -- (0,1) node[above]{Value of $I$}; % z
      \draw[->,semithick] (0,0) -- +(-30:1) node[below right]{$h$}; % x
      \draw[->,semithick] (0,0) -- +(210:1) node[below left]{$u$}; % y
    \end{tikzpicture}
    \caption{Orientation of the axes used throughout the 3D plots}
    \label{fig:orientation-of-axes}
  \end{figure}

  To plot $u$ and $h$ we need to know their respective ranges as well. This is noted in the caption of the whole figure. For example, in figure \ref{fig:two-points-all-the-same}, the values for $u$ are in $[9.5, 10.5]$ and the values for $h$ in $[-1,1]$.

  Looking back at the caption of the subfigure, which had ``1/0.04'' in the latter part (subfigure \ref{subfig:fixing-p2-in-first-example}). This tells us the range of the values of $I$ (i.e. the ``$z$ axis''). To be precise, the firs part tells us that the maximal plotted value for the h component is 1, while the maximal $u$ component value is 0.04. A single number indicates a range between 0 and that number, while an explicit range indicates the given range (for an example, see \ref{subfig:example-with-range}, where the $h$ component plot range goes from 0.25 to 0.55, and the $u$ component from 0 to 0.03).

  \section{Gaussian quadrature and distribution of support points}
  \label{sec:results}

  We implemented several scenarios and present the outcome of some of them using the support points one would use when doing a Gaussian quadrature. The $x$ values of these support points are summed up in this table:

  \begin{table}[ht]
    \renewcommand\arraystretch{1.5}
    \centering
    \begin{tabular}[ht]{cl}
      Order & $x$ coordinates \\
      \hline
      2 & $\frac{1}{2}-\frac{1}{6}\cdot \sqrt{3}, \frac{1}{2}+\frac{1}{6}\cdot \sqrt{3}$ \\
      3 & $-\frac{1}{10}\cdot \sqrt{15}+\frac{1}{2} , 0.5, \frac{1}{10}\cdot \sqrt{15}+\frac{1}{2}$ \\
      \hline 
    \end{tabular}
    \caption{$x$ coordinates of support points for Gaussian quadrature}
    \label{tab:x-coordinates-gauss-quadrature}
  \end{table}

  \subsection{Setting all support points to the same value}
  \label{sec:setting-all-support-points-to-the-same-value}

  First we set all support points to one single value ensuring homogenous height and impulse. Then, we tackle each point individually and let it's values range over a certain domain.

  \begin{figure}[ht]
    \centering
    \subfigure[$p_1$: 1/0.04]{
      \includegraphics[scale=\zoomfactor]{2_equal_10_0/1_h.png} 
      \includegraphics[scale=\zoomfactor]{2_equal_10_0/1_u.png}
    }
    \subfigure[$p_2$: 1/0.04]{
      \label{subfig:fixing-p2-in-first-example}
      \includegraphics[scale=\zoomfactor]{2_equal_10_0/2_h.png} 
      \includegraphics[scale=\zoomfactor]{2_equal_10_0/2_u.png}
    }
    \subfigure[$P_1$: 1 / 0.04]{
      \includegraphics[scale=\zoomfactor]{2_equal_10_0/3_h.png} 
      \includegraphics[scale=\zoomfactor]{2_equal_10_0/3_u.png}
    }
    \subfigure[$P_2$: 1 / 0.04]{
      \includegraphics[scale=\zoomfactor]{2_equal_10_0/4_h.png} 
      \includegraphics[scale=\zoomfactor]{2_equal_10_0/4_u.png} 
    }
    \caption{Two points for each triangle. All support points have height 10 and impulse 0. $h$ ranges from 9.5 to 10.5, $u$ from -1 to 1.}
    \label{fig:two-points-all-the-same}
  \end{figure}

  Figure \ref{fig:two-points-all-the-same} shows the case for two points on each adjacent edge. The sub-figures are interpreted the following way: Each subfigure shows what happens if we fix all but one specific support point. For example, subfigure \ref{subfig:fixing-p2-in-first-example} shows what happens if we fix all support points except $p_2$ (containing the variables $h_2$ and $u_2$) and let range $h_2$ from 9.5 to 10.5 and $u_2$ from -1 to 1. The left part of subfigure \ref{subfig:fixing-p2-in-first-example} shows the error in the $h$-component, while the right half depicts the error in the $u$ component.

  As you can see, the error for the $h$ component ranges up to 1, while the error in the $u$-component is probably negligible (namely about 0.04).

  Of course it would be interesting to inspect the same thing for more support points along each edge. So we did for three support points along each edge. You can see the results in figure \ref{fig:three-points-equal}. Please note that the structure of the error plots seems to be the same all over. However, the error ranges vary slightly. For example, varying $P_2$ instead of $P_1$ (when using three points) results in different error levels (see figure \ref{subfig:3-points-ranging-P2} resp. \ref{subfig:3-points-ranging-P1}).

  \begin{figure}[ht]
    \centering
    \subfigure[$p_1$: 0.8 / 0.03]{
      \label{subfig:3-points-equal-p1}
      \includegraphics[scale=\zoomfactor]{3_equal/1_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal/1_u.png} 
    }
    \subfigure[$p_2$: 1.2 / 0.05]{
      \includegraphics[scale=\zoomfactor]{3_equal/2_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal/2_u.png} 
    }
    \subfigure[$p_3$: 0.8 / 0.03]{
      \includegraphics[scale=\zoomfactor]{3_equal/3_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal/3_u.png} 
    }
    \subfigure[$P_1$: 0.8 / 0.03]{
      \label{subfig:3-points-ranging-P1}
      \includegraphics[scale=\zoomfactor]{3_equal/4_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal/4_u.png} 
    }
    \subfigure[$P_2$: 1.2 / 0.05]{
      \label{subfig:3-points-ranging-P2}
      \includegraphics[scale=\zoomfactor]{3_equal/5_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal/5_u.png} 
    }
    \subfigure[$P_3$: 0.8 / 0.03]{
      \includegraphics[scale=\zoomfactor]{3_equal/6_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal/6_u.png} 
    }
    \caption{Three points for each triangle. Points have height 10, impulse 0.}
    \label{fig:three-points-equal}
  \end{figure}

  \subsection{One point variation}
  \label{sec:one-point-variation}

  \subsubsection{Decreasing the height of $p_1$}
  \label{sec:decreasing-height-p1}

  Now we alter the previously described experiment in one detail. We fix all points as before, but we alter \emph{one} single point slightly. We do this in order to find out if specific points might have more impact than others.

  We start off by using three points per edge, setting each point to $
  \begin{pmatrix}
    10 \\ 0
  \end{pmatrix}$ except $p_1$ wich is set to $
  \begin{pmatrix}
    9 \\ 0
  \end{pmatrix}
  $ (i.e. we decrease the height-component of $p_1$).

  \begin{figure}[ht]
    \centering
    \subfigure[$p_1$: 0.8 / 0.03]{
      \label{subfig:3-points-h1--equal-p1}
      \includegraphics[scale=\zoomfactor]{3_equal_h1-/1_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_h1-/1_u.png} 
    }
    \subfigure[$p_2$: 1.6 / 0.1]{
      \includegraphics[scale=\zoomfactor]{3_equal_h1-/2_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_h1-/2_u.png} 
    }
    \subfigure[$p_3$: 0.5 / 0.04]{
      \includegraphics[scale=\zoomfactor]{3_equal_h1-/3_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_h1-/3_u.png} 
    }
    \subfigure[$P_1$: 1.1 / 0.03]{
      \label{subfig:3-points-h1--ranging-P1}
      \includegraphics[scale=\zoomfactor]{3_equal_h1-/4_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_h1-/4_u.png} 
    }
    \subfigure[$P_2$: 1.3 / 0.05]{
      \label{subfig:3-points-h1--ranging-P2}
      \includegraphics[scale=\zoomfactor]{3_equal_h1-/5_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_h1-/5_u.png} 
    }
    \subfigure[$P_3$: {$[0.25,0.55]$} /  0.03]{
      \includegraphics[scale=\zoomfactor]{3_equal_h1-/6_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_h1-/6_u.png} 
    }
    \caption{Three points for each triangle. All points except $p_1$ have height 10, impulse 0. Point $p_1$ is set to $(9,0)$.}
    \label{fig:three-points-h1-}
  \end{figure}

  You see the results of this experiment in figure \ref{fig:three-points-h1-}. Please note that figure \ref{subfig:3-points-h1--equal-p1} and \ref{subfig:3-points-equal-p1} depict exactly the same thing, since $p_1$ is the only point we changed to differ from all the other points.

  Comparing figure \ref{fig:three-points-equal} and \ref{fig:three-points-h1-} it's worth noting that especially the plots for $p_2$, $p_3$ and -- surprisingly -- $P_3$ differ strongly. Additionally, it can be seen that the structure differs as well as the range of the error.

  \subsubsection{Decreasing the impulse of $p_1$}
  \label{sec:decreasing-impulse-p1}

  While we changed the height in subsection \ref{sec:decreasing-height-p1}, we are now going to change the impulse. The results are shown in figure \ref{fig:three-points-u1-}

  \begin{figure}[ht]
    \centering
    \subfigure[$p_1$: 0.8 / 0.03]{
      \includegraphics[scale=\zoomfactor]{3_equal_u1-/1_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_u1-/1_u.png} 
    }
    \subfigure[$p_2$: 2.5 / 0.07]{
      \includegraphics[scale=\zoomfactor]{3_equal_u1-/2_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_u1-/2_u.png} 
    }
    \subfigure[$p_3$: 1 / 0.03]{
      \includegraphics[scale=\zoomfactor]{3_equal_u1-/3_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_u1-/3_u.png} 
    }
    \subfigure[$P_1$: {$[0.7, 1.5]$} / 0.03]{
      \includegraphics[scale=\zoomfactor]{3_equal_u1-/4_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_u1-/4_u.png} 
    }
    \subfigure[$P_2$: 1 / 0.05]{
      \includegraphics[scale=\zoomfactor]{3_equal_u1-/5_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_u1-/5_u.png} 
    }
    \subfigure[$P_3$: {$[0.45,0.65]$} /  0.03]{
      \label{subfig:example-with-range}
      \includegraphics[scale=\zoomfactor]{3_equal_u1-/6_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_u1-/6_u.png} 
    }
    \caption{Three points for each triangle. All points except $p_1$ have height 10, impulse 0. Point $p_1$ is set to $(10,-1)$.}
    \label{fig:three-points-u1-}
  \end{figure}

  Again, the plots for $p_2$, $p_3$ and $P_6$ differ in structure extremely from those depicted in figure \ref{fig:three-points-equal}. In this context it would be interesting to know what happens with the plot of the height of $p_3$ if the impulse grows bigger than 1, since it looks like the error goes down at the left end. We created a plot that shows the behaviour of the error when $p_3$ ranges. It is depicted in figure \ref{fig:examining-p3-three-points}. As you can see, it was just an ``optical illustion'' due to the particular ranges we chose for the $h$- and $u$- component. The error grows towards the borders.

  \begin{figure}[ht]
    \centering
    \includegraphics[scale=\autozoomfactor]{3_fix_p1_u_larger2/3_h.png}
    \includegraphics[scale=\autozoomfactor]{3_fix_p1_u_larger2/3_u.png}
    \caption{Examining $p_3$ for three points, all having value $(10,0)$ except $p_1$ having $(10,-1)$. The error in the $h$-component grows up to 15, while the error in $u$ reaches a maximum of 0.55 ($u$ ranging in $[-2,2]$, $h$ ranging in $[6,14]$)}
    \label{fig:examining-p3-three-points}
  \end{figure}

  Moreover, the error for $p_2$ increases to 2.5.

  \subsubsection{Decreasing the height of $p_2$}
  \label{sec:decreasing-height-p2}

  Now we are going to examine if it makes a difference if we decrease the height of another point, namely $p_2$. We show the results in figure \ref{fig:three-points-h2-}. In this case, in particular the graphs for points $p_1$ and $p_3$ catch one's eye.

  \begin{figure}[ht]
    \centering
    \subfigure[$p_1$: {$[0.4, 1.4]$} / 0.1]{
      \includegraphics[scale=\zoomfactor]{3_equal_h2-/1_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_h2-/1_u.png} 
    }
    \subfigure[$p_2$: 1.2 / 0.05]{
      \includegraphics[scale=\zoomfactor]{3_equal_h2-/2_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_h2-/2_u.png} 
    }
    \subfigure[$p_3$: {$[0.6, 1.4]$} / 0.1]{
      \includegraphics[scale=\zoomfactor]{3_equal_h2-/3_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_h2-/3_u.png} 
    }
    \subfigure[$P_1$: {$[0.5, 1]$} / 0.03]{
      \includegraphics[scale=\zoomfactor]{3_equal_h2-/4_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_h2-/4_u.png} 
    }
    \subfigure[$P_2$: {$[0.6, 1.6]$} / 0.05]{
      \includegraphics[scale=\zoomfactor]{3_equal_h2-/5_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_h2-/5_u.png} 
    }
    \subfigure[$P_3$: {$[0.6, 1]$} /  0.03]{
      \includegraphics[scale=\zoomfactor]{3_equal_h2-/6_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_h2-/6_u.png} 
    }
    \caption{Three points for each triangle. All points except $p_2$ have height 10, impulse 0. Point $p_2$ is set to $(9,0)$.}
    \label{fig:three-points-h2-}
  \end{figure}

  \subsubsection{Decreasing the impulse of $p_2$}
  \label{sec:decreasing-impulse-of-p2}

  Decreasing the impulse of point $p_2$ results in the plots depicted in figure \ref{fig:three-points-u2-}. In particular, the graphs for $p_1$ and $p_3$ show significant structural differences.

  \begin{figure}[ht]
    \centering
    \subfigure[$p_1$: {$[0.6, 2.5]$} / 0.06]{
      \includegraphics[scale=\zoomfactor]{3_equal_u2-/1_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_u2-/1_u.png} 
    }
    \subfigure[$p_2$: 1.2 / 0.05]{
      \includegraphics[scale=\zoomfactor]{3_equal_u2-/2_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_u2-/2_u.png} 
    }
    \subfigure[$p_3$: {$[0.5, 2.7]$} / 0.06]{
      \includegraphics[scale=\zoomfactor]{3_equal_u2-/3_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_u2-/3_u.png} 
    }
    \subfigure[$P_1$: {$[1, 1.4]$} / 0.03]{
      \includegraphics[scale=\zoomfactor]{3_equal_u2-/4_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_u2-/4_u.png} 
    }
    \subfigure[$P_2$: {$[1.2, 2.2]$} / 0.05]{
      \includegraphics[scale=\zoomfactor]{3_equal_u2-/5_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_u2-/5_u.png} 
    }
    \subfigure[$P_3$: {$[1, 1.4]$} /  0.03]{
      \includegraphics[scale=\zoomfactor]{3_equal_u2-/6_h.png} 
      \includegraphics[scale=\zoomfactor]{3_equal_u2-/6_u.png} 
    }
    \caption{Three points for each triangle. All points except $p_2$ have height 10, impulse 0. Point $p_2$ is set to $(10,-1)$.}
    \label{fig:three-points-u2-}
  \end{figure}

  \subsection{Random values}
  \label{sec:random-values}

  And now for something completely different. Up to now, we assigned specific values to the points and looked what happened. But it might be interesting as well what happens if we supply random values to the points.

  \subsubsection{Two random points}
  \label{sec:two-random-points}

  Let's start out with two random points. We see the results of random assignment of values in figure \ref{fig:two-points-random}. As you can see, there are heavy structural differences. The maximum error concerning the height is about 6.

  \begin{figure}[ht]
    \centering
    \subfigure[$p_1$: {$[1,3]$} / 0.1]{
      \includegraphics[scale=\zoomfactor]{2_random/1_h.png} 
      \includegraphics[scale=\zoomfactor]{2_random/1_u.png}
    }
    \subfigure[$p_2$: {$[1, 2.6]$} / 0.16]{
      \includegraphics[scale=\zoomfactor]{2_random/2_h.png} 
      \includegraphics[scale=\zoomfactor]{2_random/2_u.png}
    }  
    \subfigure[$P_1$: 4 / 0.2]{
      \includegraphics[scale=\zoomfactor]{2_random/3_h.png} 
      \includegraphics[scale=\zoomfactor]{2_random/3_u.png}
    }
    \subfigure[$P_2$: {$[1,6]$} / 0.2]{
      \includegraphics[scale=\zoomfactor]{2_random/4_h.png} 
      \includegraphics[scale=\zoomfactor]{2_random/4_u.png} 
    }
    \caption{Two points for each triangle. Values for the points are: $u_1^R = -0.082$, $h_1^R = 9.4$, $u_2^R = -0.45$, $h_2^R = 10.33$, $u_1^L = -1.32$, $h_1^L = 9.45$, $u_2^L = -0.75$, $h_2^L = 10.72$. }
    \label{fig:two-points-random}
  \end{figure}

  \subsubsection{Three random points}
  \label{sec:three-random-points}

  Same game for three random points is shown in figure \ref{fig:three-points-random}. As you can see, it differs strongly from figure \ref{fig:three-points-equal}, where we set all points to the same value.

  \begin{figure}[ht]
    \centering
    \subfigure[$p_1$: {$[1, 2.2]$} / 0.12]{
      \includegraphics[scale=\zoomfactor]{3_random/1_h.png} 
      \includegraphics[scale=\zoomfactor]{3_random/1_u.png} 
    }
    \subfigure[$p_2$: {$[1, 3]$} / 0.12]{
      \includegraphics[scale=\zoomfactor]{3_random/2_h.png} 
      \includegraphics[scale=\zoomfactor]{3_random/2_u.png} 
    }
    \subfigure[$p_3$: {$[1.2, 1.7]$} / {$[0.05, 0.11]$}]{
      \includegraphics[scale=\zoomfactor]{3_random/3_h.png} 
      \includegraphics[scale=\zoomfactor]{3_random/3_u.png} 
    }
    \subfigure[$P_1$: {$[1, 4.5]$} / 0.18]{
      \includegraphics[scale=\zoomfactor]{3_random/4_h.png} 
      \includegraphics[scale=\zoomfactor]{3_random/4_u.png} 
    }
    \subfigure[$P_2$: {$[1, 4.5]$} / {$[0.04, 0.16]$}]{
      \includegraphics[scale=\zoomfactor]{3_random/5_h.png} 
      \includegraphics[scale=\zoomfactor]{3_random/5_u.png} 
    }
    \subfigure[$P_3$: {$[1.5, 5]$} /  {$[0.06, 0.12]$}]{
      \includegraphics[scale=\zoomfactor]{3_random/6_h.png} 
      \includegraphics[scale=\zoomfactor]{3_random/6_u.png} 
    }
    \caption{Three random points for each triangle}
    \label{fig:three-points-random}
  \end{figure}

  \clearpage

  \section{Equidistant distribution of support points}
  \label{sec:equidistant-distribution-of-support-points}

  When one considers the figures depicted in section \ref{sec:results}, it seems convenient to assume that the error grows if the values for $h$ and $u$ get ``more exotic'' (i.e. if they diverge more from the average).

  One suspicion why this is the case was because of the fact that the polynomials $N(x)$ and $N'(x)$ might diverge towards the borders of $[0,1]$.

  So, we chose the support points equidistant over the interval $[0,1]$ and conducted some experiments. When we choose the support points equidistant over this interval, 0 and 1 are surely support points and we can be sure that $N(x)$ and $N'(x)$ coincide at the values 0 and 1 (i.e. $N(0)=N'(0)$ and $N(1)=N'(1)$).

  In this section, we show some results that were obtained by choosing the support points equidistant along the edge.

  \subsection{Three fixed support points}
  \label{sec:equidistant-three-fixed}

  We started as in section \ref{sec:setting-all-support-points-to-the-same-value} and set all support points to $
  \begin{pmatrix}
    10 \\ 0
  \end{pmatrix}$. You can see the resulting plots in figure \ref{fig:three-equidistant-all-fixed}. Interestingly, these plots -- at least somewhat -- look like the ones depicted in figure \ref{fig:three-points-equal}, where we considered the same situation for Gauss-Quadrature support points. Even the range of the error is not very different.

  \input{3_equidist_fix/figure.tex}

  \section{Conclusions from the things seen}
  \label{sec:conslusions}

  What all plots have in common is the fact that it looks as if towards the borders the error grows. Trying to derive an exact statement of how large the error is depending on the support point values seems a bit witless since there are too many variables that interact with each other.

  \subsection{Making this interactive}
  \label{sec:making-the-whole-thing-interactive}

  As you might know, Maple supports kind of ``dynamic plotting''. That is, you get a window containing one slider for each variable in a mathematical expression. You can then plot this expression

\end{comment}

\backupend

\end{document}
